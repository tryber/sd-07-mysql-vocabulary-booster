-- SELECT j.JOB_TITLE AS Cargo, ROUND(AVG(e.SALARY),2)
-- AS `Média Salarial`,
-- CASE
-- WHEN ROUND(AVG(e.SALARY),2) BETWEEN 2000.00 AND 5800.00 THEN "Júnior"
-- WHEN ROUND(AVG(e.SALARY),2) BETWEEN 5801.00 AND 7500.00 THEN 'Pleno'
-- WHEN ROUND(AVG(e.SALARY),2) BETWEEN 7501.00 AND 10500.00 THEN 'Sênior'
-- WHEN ROUND(AVG(e.SALARY),2) > 10500.00 THEN 'CEO'
-- END AS Senioridade
-- FROM hr.jobs AS j
-- JOIN hr.employees AS e
-- ON j.JOB_ID = e.JOB_ID 
-- GROUP BY Cargo
-- ORDER BY 
-- 2,
-- Cargo;
-- SELECT JOB_TITLE AS Cargo,
-- (SELECT ROUND(AVG(SALARY),2) 
-- FROM hr.employees 
-- WHERE employees.JOB_ID = jobs.JOB_ID)
-- AS `Média Salarial`,
-- CASE
-- WHEN 'Média Salarial' BETWEEN 2000.00 AND 5800.00 THEN 'Júnior'
-- WHEN 'Média Salarial' BETWEEN 5801.00 AND 7500.00 THEN 'Pleno'
-- WHEN 'Média Salarial' BETWEEN 7501.00 AND 10500.00 THEN 'Sênior'
-- WHEN 'Média Salarial' > 10500.00 THEN 'CEO'
-- END AS Senioridade
-- FROM hr.jobs
-- ORDER BY `Média Salarial`, Cargo;
SELECT JOB_TITLE AS Cargo,
ROUND((MAX_SALARY + MIN_SALARY)/2,2) AS `Média Salarial`,
CASE
WHEN ROUND((MAX_SALARY + MIN_SALARY)/2,2) BETWEEN 2000.00 AND 5800.00 THEN "Júnior"
WHEN ROUND((MAX_SALARY + MIN_SALARY)/2,2) BETWEEN 5801.00 AND 7500.00 THEN 'Pleno'
WHEN ROUND((MAX_SALARY + MIN_SALARY)/2,2) BETWEEN 7501.00 AND 10500.00 THEN 'Sênior'
WHEN ROUND((MAX_SALARY + MIN_SALARY)/2,2) > 10500.00 THEN 'CEO'
END Senioridade
FROM hr.jobs
ORDER BY 2,1;
